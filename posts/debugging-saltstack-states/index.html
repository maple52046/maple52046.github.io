<!DOCTYPE html>
<html><head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Debugging Saltstack States - 世界的盡頭</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="利用 Saltstack 安裝 OpenStack Keystone。按照 OpenStack 官方安裝手冊，裝完 Keystone 之後，必須要為 Keystone 自己註冊 service 與 endpoint。
這一個步驟，我把他寫成 Saltstack states 如下：
waiting-keystone-startup:
  cmd.run:
    - name: sleep 1

registry-keystone-service:
  keystone.service_present:
    - name: keystone
    - service_type: identity
    - description: &#34;OpenStack Identity&#34;
    - require:
      - cmd: waiting-keystone-startup

registry-keystone-endpoint:
  keystone.endpoint_present:
    - name: keystone
    - publicurl: http://host-01:5000/v2.0
    - internalurl: http://host-01:5000/v2.0
    - adminurl: http://host-01:35357/v2.0
    - region: regionOne
    - require:
      - keystone: registry-keystone-service
結果執行時發生 KeyError:
user@host-01:/srv/salt/openstack/keystone$ salt &#39;*&#39; state.sls openstack.keystone.registry
host-01:
    The minion function caused an exception: Traceback (most recent call last):
      File &#34;/usr/lib/python2.7/dist-packages/salt/minion.py&#34;, line 1161, in _thread_return
        return_data = func(*args, **kwargs)
      File &#34;/usr/lib/python2.7/dist-packages/salt/modules/state.py&#34;, line 681, in sls
        ret = st_.state.call_high(high_)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 2067, in call_high
        ret = dict(list(disabled.items()) &#43; list(self.call_chunks(chunks).items()))
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1623, in call_chunks
        running = self.call_chunk(low, running, chunks)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1769, in call_chunk
        self._mod_init(low)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 612, in _mod_init
        self.states[&#39;{0}.{1}&#39;.format(low[&#39;state&#39;], low[&#39;fun&#39;])]  # pylint: disable=W0106
      File &#34;/usr/lib/python2.7/dist-packages/salt/utils/lazy.py&#34;, line 90, in __getitem__
        raise KeyError(key)
    KeyError: &#39;keystone.service_present&#39;
" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Debugging Saltstack States" />
<meta property="og:description" content="利用 Saltstack 安裝 OpenStack Keystone。按照 OpenStack 官方安裝手冊，裝完 Keystone 之後，必須要為 Keystone 自己註冊 service 與 endpoint。
這一個步驟，我把他寫成 Saltstack states 如下：
waiting-keystone-startup:
  cmd.run:
    - name: sleep 1

registry-keystone-service:
  keystone.service_present:
    - name: keystone
    - service_type: identity
    - description: &#34;OpenStack Identity&#34;
    - require:
      - cmd: waiting-keystone-startup

registry-keystone-endpoint:
  keystone.endpoint_present:
    - name: keystone
    - publicurl: http://host-01:5000/v2.0
    - internalurl: http://host-01:5000/v2.0
    - adminurl: http://host-01:35357/v2.0
    - region: regionOne
    - require:
      - keystone: registry-keystone-service
結果執行時發生 KeyError:
user@host-01:/srv/salt/openstack/keystone$ salt &#39;*&#39; state.sls openstack.keystone.registry
host-01:
    The minion function caused an exception: Traceback (most recent call last):
      File &#34;/usr/lib/python2.7/dist-packages/salt/minion.py&#34;, line 1161, in _thread_return
        return_data = func(*args, **kwargs)
      File &#34;/usr/lib/python2.7/dist-packages/salt/modules/state.py&#34;, line 681, in sls
        ret = st_.state.call_high(high_)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 2067, in call_high
        ret = dict(list(disabled.items()) &#43; list(self.call_chunks(chunks).items()))
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1623, in call_chunks
        running = self.call_chunk(low, running, chunks)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1769, in call_chunk
        self._mod_init(low)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 612, in _mod_init
        self.states[&#39;{0}.{1}&#39;.format(low[&#39;state&#39;], low[&#39;fun&#39;])]  # pylint: disable=W0106
      File &#34;/usr/lib/python2.7/dist-packages/salt/utils/lazy.py&#34;, line 90, in __getitem__
        raise KeyError(key)
    KeyError: &#39;keystone.service_present&#39;
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://maple52046.github.io/posts/debugging-saltstack-states/" /><meta property="og:image" content="https://maple52046.github.io/site-thumbnail.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-10-16T12:54:13+08:00" />
<meta property="article:modified_time" content="2015-10-16T12:54:13+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://maple52046.github.io/site-thumbnail.png" /><meta name="twitter:title" content="Debugging Saltstack States"/>
<meta name="twitter:description" content="利用 Saltstack 安裝 OpenStack Keystone。按照 OpenStack 官方安裝手冊，裝完 Keystone 之後，必須要為 Keystone 自己註冊 service 與 endpoint。
這一個步驟，我把他寫成 Saltstack states 如下：
waiting-keystone-startup:
  cmd.run:
    - name: sleep 1

registry-keystone-service:
  keystone.service_present:
    - name: keystone
    - service_type: identity
    - description: &#34;OpenStack Identity&#34;
    - require:
      - cmd: waiting-keystone-startup

registry-keystone-endpoint:
  keystone.endpoint_present:
    - name: keystone
    - publicurl: http://host-01:5000/v2.0
    - internalurl: http://host-01:5000/v2.0
    - adminurl: http://host-01:35357/v2.0
    - region: regionOne
    - require:
      - keystone: registry-keystone-service
結果執行時發生 KeyError:
user@host-01:/srv/salt/openstack/keystone$ salt &#39;*&#39; state.sls openstack.keystone.registry
host-01:
    The minion function caused an exception: Traceback (most recent call last):
      File &#34;/usr/lib/python2.7/dist-packages/salt/minion.py&#34;, line 1161, in _thread_return
        return_data = func(*args, **kwargs)
      File &#34;/usr/lib/python2.7/dist-packages/salt/modules/state.py&#34;, line 681, in sls
        ret = st_.state.call_high(high_)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 2067, in call_high
        ret = dict(list(disabled.items()) &#43; list(self.call_chunks(chunks).items()))
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1623, in call_chunks
        running = self.call_chunk(low, running, chunks)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1769, in call_chunk
        self._mod_init(low)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 612, in _mod_init
        self.states[&#39;{0}.{1}&#39;.format(low[&#39;state&#39;], low[&#39;fun&#39;])]  # pylint: disable=W0106
      File &#34;/usr/lib/python2.7/dist-packages/salt/utils/lazy.py&#34;, line 90, in __getitem__
        raise KeyError(key)
    KeyError: &#39;keystone.service_present&#39;
"/>

	
        <link href="https://maple52046.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://maple52046.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css" />

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://maple52046.github.io">世界的盡頭</a>
	</div>
	<nav>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Debugging Saltstack States</h1>
			<div class="meta">Posted on Oct 16, 2015</div>
		</div>
		

		<section class="body">
			<p>利用 Saltstack 安裝 OpenStack Keystone。按照 <a href="http://docs.openstack.org/kilo/install-guide/install/apt/content/keystone-services.html">OpenStack 官方安裝手冊</a>，裝完 Keystone 之後，必須要為 Keystone 自己註冊 service 與 endpoint。</p>
<p>這一個步驟，我把他寫成 Saltstack states 如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">waiting-keystone-startup</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">cmd.run</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">sleep 1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">registry-keystone-service</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">keystone.service_present</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">keystone</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">service_type</span>: <span style="color:#ae81ff">identity</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">description</span>: <span style="color:#e6db74">&#34;OpenStack Identity&#34;</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">require</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">cmd</span>: <span style="color:#ae81ff">waiting-keystone-startup</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">registry-keystone-endpoint</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">keystone.endpoint_present</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">keystone</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">publicurl</span>: <span style="color:#ae81ff">http://host-01:5000/v2.0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">internalurl</span>: <span style="color:#ae81ff">http://host-01:5000/v2.0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">adminurl</span>: <span style="color:#ae81ff">http://host-01:35357/v2.0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">region</span>: <span style="color:#ae81ff">regionOne</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">require</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">keystone</span>: <span style="color:#ae81ff">registry-keystone-service</span>
</span></span></code></pre></div><p>結果執行時發生 KeyError:</p>
<pre tabindex="0"><code>user@host-01:/srv/salt/openstack/keystone$ salt &#39;*&#39; state.sls openstack.keystone.registry
host-01:
    The minion function caused an exception: Traceback (most recent call last):
      File &#34;/usr/lib/python2.7/dist-packages/salt/minion.py&#34;, line 1161, in _thread_return
        return_data = func(*args, **kwargs)
      File &#34;/usr/lib/python2.7/dist-packages/salt/modules/state.py&#34;, line 681, in sls
        ret = st_.state.call_high(high_)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 2067, in call_high
        ret = dict(list(disabled.items()) + list(self.call_chunks(chunks).items()))
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1623, in call_chunks
        running = self.call_chunk(low, running, chunks)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1769, in call_chunk
        self._mod_init(low)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 612, in _mod_init
        self.states[&#39;{0}.{1}&#39;.format(low[&#39;state&#39;], low[&#39;fun&#39;])]  # pylint: disable=W0106
      File &#34;/usr/lib/python2.7/dist-packages/salt/utils/lazy.py&#34;, line 90, in __getitem__
        raise KeyError(key)
    KeyError: &#39;keystone.service_present&#39;
</code></pre><h3 id="問題主因">問題主因</h3>
<p>先說結果：
Keystone 本身是安裝在其他 node 上，安裝後我沒有去確認 Keystone 是否正常運作。問題的主因在於 Saltstack minion 在執行 <code>keystone.service_present</code>，要先載入 keystone.auth。而 Keystone 並沒有真正運行，造成 module 載入失敗。</p>
<p>解決辦法只要確認 Keystone 有正常運作，就可以避免此問題。</p>
<hr>
<p>以下是我在追尋問題的過程與一些心得。</p>
<p>通常 Saltatck 發生 KeyError，在過往的經驗，都是帶入了無法錯誤的參數，因此我仔細檢查我的 code。
但是不論是 <a href="https://docs.saltstack.com/en/latest/ref/states/all/salt.states.keystone.html#module-salt.states.keystone">Saltstack 官方的文件</a>或是看 source code(<code>/usr/lib/python2.7/dist-packages/salt/states/keystone.py</code>)，都找不到有任何我帶錯參數的地方。</p>
<p>因此，只能開啟 Debug mode 看看能不能抓到任何蛛絲馬跡.</p>
<h3 id="trun-on-debug-mode">Trun on Debug mode</h3>
<p>編輯 <code>/etc/salt/minion</code>，設定：<code>log_level: debug</code>，然後重新啟動 salt-minion。</p>
<p>接下來我們就要觀察 <code>/var/log/salt/minion</code>。</p>
<h3 id="start-debuging">Start debuging</h3>
<p>首先，重複執行 job <em>(ex:</em> <code>salt '*' state.sls openstack.keystone.registry</code> <em>)</em></p>
<p>等待錯誤回報之後，打開 <code>/var/log/salt/minion</code></p>
<p>Job 執行時，log 的開頭是:</p>
<pre tabindex="0"><code>2015-10-16 12:37:17,375 [salt.minion      ][INFO    ][19647] User root Executing command state.sls with jid 20151016043717370854
2015-10-16 12:37:17,375 [salt.minion      ][DEBUG   ][19647] Command details {&#39;tgt_type&#39;: &#39;glob&#39;, &#39;jid&#39;: &#39;20151016043717370854&#39;, &#39;tgt&#39;: &#39;*&#39;, &#39;ret&#39;: &#39;&#39;, &#39;user&#39;: &#39;root&#39;, &#39;arg&#39;: [&#39;openstack.keystone.registry&#39;], &#39;fun&#39;: &#39;state.sls&#39;}
2015-10-16 12:37:17,380 [salt.minion      ][INFO    ][21811] Starting a new job with PID 21811
2015-10-16 12:37:17,387 [salt.utils.lazy  ][DEBUG   ][21811] LazyLoaded state.sls
2015-10-16 12:37:17,395 [salt.utils.lazy  ][DEBUG   ][21811] LazyLoaded saltutil.is_running
2015-10-16 12:37:17,396 [salt.utils.lazy  ][DEBUG   ][21811] LazyLoaded grains.get
2015-10-16 12:37:17,397 [salt.crypt       ][DEBUG   ][21811] Re-using SAuth for (&#39;/etc/salt/pki/minion&#39;, &#39;host-01&#39;, &#39;tcp://192.168.0.1:4506&#39;)
2015-10-16 12:37:17,414 [salt.config      ][DEBUG   ][21811] Reading configuration from /etc/salt/minion
</code></pre><p>可以看到 Job ID, &hellip; 資訊。接著往下看，可以發現，minion 的運作流程：</p>
<ol>
<li>驗證</li>
<li>載入所需要的模組(函式)</li>
</ol>
<pre tabindex="0"><code>2015-10-16 12:37:17,387 [salt.utils.lazy  ][DEBUG   ][21811] LazyLoaded state.sls
2015-10-16 12:37:17,395 [salt.utils.lazy  ][DEBUG   ][21811] LazyLoaded saltutil.is_running
2015-10-16 12:37:17,396 [salt.utils.lazy  ][DEBUG   ][21811] LazyLoaded grains.get
</code></pre><ol start="3">
<li>載入 configuration</li>
</ol>
<pre tabindex="0"><code>2015-10-16 12:37:17,414 [salt.config      ][DEBUG   ][21811] Reading configuration from /etc/salt/minion
2015-10-16 12:37:17,450 [salt.config      ][DEBUG   ][21811] Including configuration from &#39;/etc/salt/minion.d/_schedule.conf&#39;
2015-10-16 12:37:17,450 [salt.config      ][DEBUG   ][21811] Reading configuration from /etc/salt/minion.d/_schedule.conf
2015-10-16 12:37:17,451 [salt.config      ][DEBUG   ][21811] Including configuration from &#39;/etc/salt/minion.d/keystone.conf&#39;
2015-10-16 12:37:17,451 [salt.config      ][DEBUG   ][21811] Reading configuration from /etc/salt/minion.d/keystone.conf
</code></pre><ol start="4">
<li>從 master 取得所需的檔案</li>
</ol>
<pre tabindex="0"><code>2015-10-16 12:37:17,645 [salt.fileclient  ][DEBUG   ][21811] Fetching file from saltenv &#39;base&#39;, ** attempting ** &#39;salt://openstack/keystone/registry.sls&#39;
2015-10-16 12:37:17,649 [salt.fileclient  ][INFO    ][21811] Fetching file from saltenv &#39;base&#39;, ** done ** &#39;openstack/keystone/registry.sls&#39;
</code></pre><ol start="5">
<li>從檔案, piller value, grains value 中，render data</li>
</ol>
<pre tabindex="0"><code>2015-10-16 12:37:17,662 [salt.template    ][DEBUG   ][21811] Rendered data from file: /var/cache/salt/minion/files/base/openstack/keystone/registry.sls:
waiting-keystone-startup:
  cmd.run:
    \- name: sleep 1

registry-keystone-service:
  keystone.service\_present:
    \- service_type: identity
    \- description: &#34;OpenStack Identity&#34;
    \- require:
      \- cmd: waiting-keystone-startup

registry-keystone-endpoint:
  keystone.endpoint\_present:
    - name: keystone
    - publicurl: http://host-01:5000/v2.0
    - internalurl: http://host-01:5000/v2.0
    - adminurl: http://host-01:35357/v2.0
    - region: regionOne
    - require:
      - keystone: registry-keystone-service
</code></pre><ol start="6">
<li>接下來就開始依照順序/相依性，先 load module/function，再執行 job。</li>
</ol>
<pre tabindex="0"><code>2015-10-16 12:37:17,669 [salt.utils.lazy  ][DEBUG   ][21811] LazyLoaded cmd.run
2015-10-16 12:37:17,669 [salt.state       ][INFO    ][21811] Running state [sleep 1] at time 12:37:17.669452
2015-10-16 12:37:17,670 [salt.state       ][INFO    ][21811] Executing state cmd.run for sleep 1
2015-10-16 12:37:17,670 [salt.loaded.int.module.cmdmod][INFO    ][21811] Executing command &#39;sleep 1&#39; in directory &#39;/root&#39;
2015-10-16 12:37:18,674 [salt.state       ][INFO    ][21811] {&#39;pid&#39;: 21834, &#39;retcode&#39;: 0, &#39;stderr&#39;: &#39;&#39;, &#39;stdout&#39;: &#39;&#39;}
2015-10-16 12:37:18,675 [salt.state       ][INFO    ][21811] Completed state [sleep 1] at time 12:37:18.674880
</code></pre><p>透過這樣一連串的步驟，就發現了問題的所在。
按照我寫的 states, <code>cmd.run</code> 執行完之後，就要執行 <code>keystone.service_present</code>。
在 log 中看到接下來發生的錯誤：</p>
<pre tabindex="0"><code>2015-10-16 12:37:18,727 [salt.loader      ][DEBUG   ][21811] Error loading module.tls: [&#39;PyOpenSSL version 0.14 or later must be installed before  this module can be used.&#39;]
2015-10-16 12:37:18,818 [salt.loader      ][DEBUG   ][21811] Error loading module.nacl: libnacl import error, perhaps missing python libnacl package
2015-10-16 12:37:18,920 [salt.loader      ][DEBUG   ][21811] Error loading module.npm: npm execution module could not be loaded because the npm binary could not be located
2015-10-16 12:37:18,943 [salt.utils.lazy  ][DEBUG   ][21811] Could not LazyLoad keystone.auth
</code></pre><p>以及</p>
<pre tabindex="0"><code>2015-10-16 12:37:19,081 [salt.loader      ][DEBUG   ][21811] Error loading states.npm: &#39;npm&#39; binary not found on system
2015-10-16 12:37:19,087 [salt.utils.lazy  ][DEBUG   ][21811] Could not LazyLoad keystone.service_present
2015-10-16 12:37:19,087 [salt.minion      ][WARNING ][21811] The minion function caused an exception
Traceback (most recent call last):
  File &#34;/usr/lib/python2.7/dist-packages/salt/minion.py&#34;, line 1161, in _thread_return
    return_data = func(*args, **kwargs)
  File &#34;/usr/lib/python2.7/dist-packages/salt/modules/state.py&#34;, line 681, in sls
    ret = st_.state.call_high(high_)
  File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 2067, in call_high
    ret = dict(list(disabled.items()) + list(self.call_chunks(chunks).items()))
  File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1623, in call_chunks
    running = self.call_chunk(low, running, chunks)
  File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1769, in call_chunk
    self._mod_init(low)
  File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 612, in _mod_init
    self.states[&#39;{0}.{1}&#39;.format(low[&#39;state&#39;], low[&#39;fun&#39;])]  # pylint: disable=W0106
  File &#34;/usr/lib/python2.7/dist-packages/salt/utils/lazy.py&#34;, line 90, in __getitem__
    raise KeyError(key)
KeyError: &#39;keystone.service_present&#39;
</code></pre><p>Log 中出現了三個 error :</p>
<ul>
<li>
<p>Fix problem (1)</p>
<p>Log 提示，PyOpenSSL 必須要是 0.14 以上的版本，於是檢查一下當前系統是否有安裝：</p>
<pre tabindex="0"><code>user@host-01:~$ sudo dpkg -l | grep python-openssl
ii  python-openssl                      0.13-2ubuntu6                    amd64        Python 2 wrapper around the OpenSSL library
</code></pre><p>apt-get 能安裝的版本，最高已經是 0.13 了。因此要裝 0.14 只能使用 pip 指令。不過建議安裝 0.15.1 以上的版本，因為我安裝了 0.14 之後，log 中有出現 <code>You should upgrade pyOpenSSL to at least 0.15.1</code></p>
<pre tabindex="0"><code>sudo apt-get install python-dev libffi-dev
sudo pip install PyOpenSSL==0.15.1
</code></pre></li>
<li>
<p>Fix problem (2)</p>
<pre tabindex="0"><code>sudo pip install libnacl
</code></pre></li>
<li>
<p>Fix problem (3)</p>
<pre tabindex="0"><code>sudo apt-get install npm
</code></pre></li>
</ul>
<p>解決了以上三個問題之後，再次執行了同樣的 job，雖然已經沒有上面三個錯誤，但結果還是得到 KeyError。
後來才發現是因為 Keystone 並沒有正常運行，造成 <code>keystone.auth</code> 載入失敗，<code>keystone.service_present</code> 也因此連帶無法載入。</p>
<hr>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="https://docs.saltstack.com/en/latest/ref/states/all/salt.states.keystone.html#module-salt.states.keystone">SALT.STATES.KEYSTONE</a></li>
<li><a href="http://stackoverflow.com/questions/12982486/glib-compile-error-ffi-h-but-libffi-is-installed">GLib compile error (ffi.h), but libffi is installed</a></li>
<li><a href="http://ask.xmodulo.com/fix-fatal-error-openssl.html">How to fix “fatal error: openssl/aes.h: No such file or directory”</a></li>
</ul>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/openstack">openstack</a></li>
					
					<li><a href="/tags/saltstack">saltstack</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2024  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-GC1G5TJVGY', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</div>
    </body>
</html>
