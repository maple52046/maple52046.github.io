<!DOCTYPE html>
<html><head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Fix the Oracle Java installation on Ubuntu 16.04 - 世界的盡頭</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="在 Ubuntu 透過 WebUpd8 team ppa 安裝 Java：
sudo add-apt-repository ppa:webupd8team/java
sudo apt update
sudo apt install oracle-java9-installer
安裝的過程中遇到 404 Not found 問題。" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Fix the Oracle Java installation on Ubuntu 16.04" />
<meta property="og:description" content="在 Ubuntu 透過 WebUpd8 team ppa 安裝 Java：
sudo add-apt-repository ppa:webupd8team/java
sudo apt update
sudo apt install oracle-java9-installer
安裝的過程中遇到 404 Not found 問題。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://maple52046.github.io/posts/fix-the-oracle-java-installation-on-ubuntu-16-04/" /><meta property="og:image" content="https://maple52046.github.io/site-thumbnail.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2017-10-19T08:38:53+00:00" />
<meta property="article:modified_time" content="2017-10-19T08:38:53+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://maple52046.github.io/site-thumbnail.png" /><meta name="twitter:title" content="Fix the Oracle Java installation on Ubuntu 16.04"/>
<meta name="twitter:description" content="在 Ubuntu 透過 WebUpd8 team ppa 安裝 Java：
sudo add-apt-repository ppa:webupd8team/java
sudo apt update
sudo apt install oracle-java9-installer
安裝的過程中遇到 404 Not found 問題。"/>

	
        <link href="https://maple52046.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://maple52046.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css" />

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://maple52046.github.io">世界的盡頭</a>
	</div>
	<nav>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Fix the Oracle Java installation on Ubuntu 16.04</h1>
			<div class="meta">Posted on Oct 19, 2017</div>
		</div>
		

		<section class="body">
			<p>在 Ubuntu 透過 <a href="https://launchpad.net/~webupd8team/+archive/ubuntu/java">WebUpd8 team ppa</a> 安裝 Java：</p>
<pre tabindex="0"><code>sudo add-apt-repository ppa:webupd8team/java
sudo apt update
sudo apt install oracle-java9-installer
</code></pre><p>安裝的過程中遇到 404 Not found 問題。</p>
<p>錯誤內容：</p>
<pre tabindex="0"><code>Downloading Oracle Java 9...
--2017-10-19 08:41:59--  http://download.oracle.com/otn-pub/java/jdk/9+181/jdk-9_linux-x64_bin.tar.gz
Resolving download.oracle.com (download.oracle.com)... 210.61.248.163, 210.61.248.216
Connecting to download.oracle.com (download.oracle.com)|210.61.248.163|:80... connected.
HTTP request sent, awaiting response... 302 Moved Temporarily
Location: https://edelivery.oracle.com/otn-pub/java/jdk/9+181/jdk-9_linux-x64_bin.tar.gz [following]
--2017-10-19 08:41:59--  https://edelivery.oracle.com/otn-pub/java/jdk/9+181/jdk-9_linux-x64_bin.tar.gz
Resolving edelivery.oracle.com (edelivery.oracle.com)... 104.116.18.92, 2600:1417:1b:188::2d3e, 2600:1417:1b:184::2d3e
Connecting to edelivery.oracle.com (edelivery.oracle.com)|104.116.18.92|:443... connected.
HTTP request sent, awaiting response... 302 Moved Temporarily
Location: http://download.oracle.com/otn-pub/java/jdk/9+181/jdk-9_linux-x64_bin.tar.gz?AuthParam=1508373839_4021b0b2a88845635225f537490b9b5a [following]
--2017-10-19 08:42:00--  http://download.oracle.com/otn-pub/java/jdk/9+181/jdk-9_linux-x64_bin.tar.gz?AuthParam=1508373839_4021b0b2a88845635225f537490b9b5a
Connecting to download.oracle.com (download.oracle.com)|210.61.248.163|:80... connected.
HTTP request sent, awaiting response... 404 Not Found
2017-10-19 08:42:01 ERROR 404: Not Found.

download failed
Oracle JDK 9 is NOT installed.
dpkg: error processing package oracle-java9-installer (--configure):
 subprocess installed post-installation script returned error exit status 1
E: Sub-process /usr/bin/dpkg returned an error code (1)
</code></pre><p>在等待官方之餘，嘗試先自己修改 deb 來解決這個問題。</p>
<!-- raw HTML omitted -->
<hr>
<h1 id="solution">Solution</h1>
<h2 id="install-tools">Install tools</h2>
<p>先安裝 tool：</p>
<pre tabindex="0"><code>sudo apt install apt-src
</code></pre><p>接下來，修改 <code>/etc/apt/sources.list.d/webupd8team-ubuntu-java-xenial.list</code>，取消 deb-src 的註解：</p>
<pre tabindex="0"><code>deb http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main
deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu xenial main
</code></pre><p>然後更新 apt-src 的資料庫：</p>
<pre tabindex="0"><code>sudo apt-src update
</code></pre><h2 id="download-deb-source">Download deb source</h2>
<p>下載 oracle-java9-installer 的 deb source：</p>
<pre tabindex="0"><code>mkdir ~/oracle-java
cd ~/oracle-java
sudo apt-src install oracle-java9-installer
</code></pre><p>這邊還是會再出現一次錯誤，不過可以忽略。</p>
<p><img src="https://i.imgur.com/k8hI5n8.png" alt=""></p>
<h2 id="modify-deb-file">Modify deb file</h2>
<h3 id="step-1">Step 1</h3>
<p>先到 <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk9-downloads-3848520.html">Oracle 官網</a> 去確認安裝檔的路徑：</p>
<p><img src="https://i.imgur.com/YN0S4mp.png" alt=""></p>
<blockquote>
<p>安裝檔 <code>jdk-9.0.1_linux-x64_bin.tar.gz</code> 的下載位址為：http://download.oracle.com/otn-pub/java/jdk/9.0.1+11/jdk-9.0.1_linux-x64_bin.tar.gz</p>
</blockquote>
<p>編輯 <code>~/oracle-java/oracle-java9-installer-9b181/debian/oracle-java9-installer.postinst</code>:</p>
<ul>
<li>將 <code>JAVA_VERSION_MAJOR</code> (line 68) 修改成 <strong><code>9.0.1</code></strong></li>
<li>將 <code>J_DIR</code> (line 71) 修改成 <strong><code>jdk-9.0.1</code></strong></li>
<li>將 <code>JAVA_VERSION_MINOR</code> (line 69) 修改成 <strong><code>11</code></strong></li>
</ul>
<p>Ex:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> ! $arch <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;arm&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  JAVA_VERSION_MAJOR<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span> <span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span>  JAVA_VERSION_MINOR<span style="color:#f92672">=</span><span style="color:#ae81ff">181</span> <span style="color:#75715e">#must be modified for each release</span>
</span></span><span style="display:flex;"><span>  JAVA_VERSION_DATE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;04_nov_2015&#34;</span> <span style="color:#75715e">#no longer needed with b95</span>
</span></span><span style="display:flex;"><span>  J_DIR<span style="color:#f92672">=</span>jdk-9 <span style="color:#75715e">#must be modified for each release</span>
</span></span><span style="display:flex;"><span>  FILENAME<span style="color:#f92672">=</span>jdk-<span style="color:#e6db74">${</span>JAVA_VERSION_MAJOR<span style="color:#e6db74">}</span>_linux-<span style="color:#e6db74">${</span>dld<span style="color:#e6db74">}</span>_bin.tar.gz <span style="color:#75715e"># jdk-9_linux-x64_bin.tar.gz</span>
</span></span><span style="display:flex;"><span>  PARTNER_URL<span style="color:#f92672">=</span>http://download.oracle.com/otn-pub/java/jdk/<span style="color:#e6db74">${</span>JAVA_VERSION_MAJOR<span style="color:#e6db74">}</span>+<span style="color:#e6db74">${</span>JAVA_VERSION_MINOR<span style="color:#e6db74">}</span>/$FILENAME
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  JAVA_VERSION_MAJOR<span style="color:#f92672">=</span>9.0.1 <span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span>  JAVA_VERSION_MINOR<span style="color:#f92672">=</span><span style="color:#ae81ff">11</span> <span style="color:#75715e">#must be modified for each release</span>
</span></span><span style="display:flex;"><span>  JAVA_VERSION_DATE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;04_nov_2015&#34;</span> <span style="color:#75715e">#no longer needed with b95</span>
</span></span><span style="display:flex;"><span>  J_DIR<span style="color:#f92672">=</span>jdk-9.0.1 <span style="color:#75715e">#must be modified for each release</span>
</span></span><span style="display:flex;"><span>  FILENAME<span style="color:#f92672">=</span>jdk-<span style="color:#e6db74">${</span>JAVA_VERSION_MAJOR<span style="color:#e6db74">}</span>_linux-<span style="color:#e6db74">${</span>dld<span style="color:#e6db74">}</span>_bin.tar.gz <span style="color:#75715e"># jdk-9+109_linux-arm64-vfp-hflt_bin.tar.gz</span>
</span></span><span style="display:flex;"><span>  PARTNER_URL<span style="color:#f92672">=</span>http://download.oracle.com/otn-pub/java/jdk/<span style="color:#e6db74">${</span>JAVA_VERSION_MAJOR<span style="color:#e6db74">}</span>+<span style="color:#e6db74">${</span>JAVA_VERSION_MINOR<span style="color:#e6db74">}</span>/$FILENAME
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h3 id="step-2">Step 2</h3>
<p>根據 <a href="">Oracle 官網</a> 的 checksum 表：</p>
<p><img src="https://i.imgur.com/K2ReH3E.png" alt=""></p>
<p>修改 <strong>SHA256SUM_TGZ</strong> (line 24) 的值：</p>
<p>Ex:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#66d9ef">case</span> <span style="color:#66d9ef">$(</span>dpkg --print-architecture<span style="color:#66d9ef">)</span> in
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;i386&#39;</span>|<span style="color:#e6db74">&#39;i586&#39;</span>|<span style="color:#e6db74">&#39;i686&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#arch=i386; dld=x86;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#SHA256SUM_TGZ=&#34;ba0c77644ece024cdb933571d79f0f035e91a9c9ab70de9c82446c9fbd000c97&#34; #must be modified for each release</span>
</span></span><span style="display:flex;"><span>  echo <span style="color:#e6db74">&#34;Error. Oracle Java 9 does not support 32bit.&#34;</span>
</span></span><span style="display:flex;"><span>  ;;
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;amd64&#39;</span>  <span style="color:#f92672">)</span> arch<span style="color:#f92672">=</span>amd64; dld<span style="color:#f92672">=</span>x64;
</span></span><span style="display:flex;"><span>  SHA256SUM_TGZ<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2cdaf0ff92d0829b510edd883a4ac8322c02f2fc1beae95d048b6716076bc014&#34;</span> <span style="color:#75715e">#must be modified for each release</span>
</span></span><span style="display:flex;"><span>  ;;
</span></span></code></pre></div><h2 id="build-deb">Build deb</h2>
<p>接下來開始 build deb 檔：</p>
<pre tabindex="0"><code>apt-src build oracle-java9-installer
</code></pre><p>完成之後，會在目錄下看到三個 deb 檔：</p>
<ul>
<li><code>oracle-java9-installer_9b181-1~webupd8~2_amd64.deb</code></li>
<li><code>oracle-java9-unlimited-jce-policy_9b181-1~webupd8~2_amd64.deb</code></li>
<li><code>oracle-java9-set-default_9b181-1~webupd8~2_amd64.deb</code></li>
</ul>
<h2 id="install-oracle-java">Install Oracle Java</h2>
<pre tabindex="0"><code>sudo dpkg -i oracle-java9-installer_9b181-1~webupd8~2_amd64.deb
sudo apt install oracle-java9-set-default
</code></pre>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/apt">apt</a></li>
					
					<li><a href="/tags/deb">deb</a></li>
					
					<li><a href="/tags/java">java</a></li>
					
					<li><a href="/tags/ubuntu">ubuntu</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2024  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-GC1G5TJVGY', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</div>
    </body>
</html>
