<!DOCTYPE html>
<html><head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>解決在 Flutter 使用 Catcher 時遇到 WidgetsFlutterBinding 初始化的問題 - 世界的盡頭</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="最近引入 Catcher 來搜集 app 發生的錯誤訊息。按照 github 上的範例修改了 main function，初始化 Catcher:
void main() async {
  WidgetsFlutterBinding.ensureInitialized();

  Catcher(
    debugConfig: CatcherOptions(SilentReportMode(), [
      ConsoleHandler(
        enableApplicationParameters: false,
        enableDeviceParameters: false,
        enableCustomParameters: false,
        enableStackTrace: true,
      ),
    ]),
    releaseConfig: CatcherOptions(
      SilentReportMode(),
      [
        HttpHandler(
          HttpRequestType.post,
          Uri.parse(&#39;https://x.y.z&#39;),
          enableApplicationParameters: true,
          enableCustomParameters: false,
          enableDeviceParameters: true,
          enableStackTrace: false,
        ),
      ],
    ),
    runAppFunction: initApp,
    navigatorKey: myRootNavKey,
  );
}

Future&lt;void&gt; initApp() async {
  /*
    此處省略一萬個 sdk 初始化步驟 .......
  */

  runApp(const RootApp());
}
結果運行時 console 顯示錯誤：
flutter: [2023-12-29 20:47:21.680324 | Catcher | INFO] Setup localization lazily!
flutter: [2023-12-29 20:47:21.694254 | Catcher | INFO] ============================ CATCHER LOG ============================
flutter: [2023-12-29 20:47:21.694391 | Catcher | INFO] Crash occurred on 2023-12-29 20:47:21.687161
flutter: [2023-12-29 20:47:21.694430 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694508 | Catcher | INFO] ---------- ERROR ----------
flutter: [2023-12-29 20:47:21.694635 | Catcher | INFO] Zone mismatch.
The Flutter bindings were initialized in a different zone than is now being used. This will likely cause confusion and bugs as any zone-specific configuration will inconsistently use the configuration of the original binding initialization zone or this zone based on hard-to-predict factors such as which zone was active when a particular callback was set.
It is important to use the same zone when calling `ensureInitialized` on the binding as when calling `runApp` later.
To make this warning fatal, set BindingBase.debugZoneErrorsAreFatal to true before the bindings are initialized (i.e. as the first statement in `void main() { }`).
flutter: [2023-12-29 20:47:21.694679 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694899 | Catcher | INFO] ------- STACK TRACE -------
flutter: [2023-12-29 20:47:21.695005 | Catcher | INFO] #0      BindingBase.debugCheckZone.&lt;anonymous closure&gt; (package:flutter/src/foundation/binding.dart:503:29)
flutter: [2023-12-29 20:47:21.695041 | Catcher | INFO] #1      BindingBase.debugCheckZone (package:flutter/src/foundation/binding.dart:508:6)
flutter: [2023-12-29 20:47:21.695076 | Catcher | INFO] #2      runApp (package:flutter/src/widgets/binding.dart:1093:18)
flutter: [2023-12-29 20:47:21.695120 | Catcher | INFO] #3      initApp (package:arena/main.dart:225:3)
flutter: [2023-12-29 20:47:21.695152 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695183 | Catcher | INFO] #4      main.&lt;anonymous closure&gt;.&lt;anonymous closure&gt; (package:arena/main.dart:108:37)
flutter: [2023-12-29 20:47:21.695213 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695270 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.695330 | Catcher | INFO] ======================================================================
flutter: [2023-12-29 20:47:21.695767 | Catcher | INFO] Report result: true
" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="解決在 Flutter 使用 Catcher 時遇到 WidgetsFlutterBinding 初始化的問題" />
<meta property="og:description" content="最近引入 Catcher 來搜集 app 發生的錯誤訊息。按照 github 上的範例修改了 main function，初始化 Catcher:
void main() async {
  WidgetsFlutterBinding.ensureInitialized();

  Catcher(
    debugConfig: CatcherOptions(SilentReportMode(), [
      ConsoleHandler(
        enableApplicationParameters: false,
        enableDeviceParameters: false,
        enableCustomParameters: false,
        enableStackTrace: true,
      ),
    ]),
    releaseConfig: CatcherOptions(
      SilentReportMode(),
      [
        HttpHandler(
          HttpRequestType.post,
          Uri.parse(&#39;https://x.y.z&#39;),
          enableApplicationParameters: true,
          enableCustomParameters: false,
          enableDeviceParameters: true,
          enableStackTrace: false,
        ),
      ],
    ),
    runAppFunction: initApp,
    navigatorKey: myRootNavKey,
  );
}

Future&lt;void&gt; initApp() async {
  /*
    此處省略一萬個 sdk 初始化步驟 .......
  */

  runApp(const RootApp());
}
結果運行時 console 顯示錯誤：
flutter: [2023-12-29 20:47:21.680324 | Catcher | INFO] Setup localization lazily!
flutter: [2023-12-29 20:47:21.694254 | Catcher | INFO] ============================ CATCHER LOG ============================
flutter: [2023-12-29 20:47:21.694391 | Catcher | INFO] Crash occurred on 2023-12-29 20:47:21.687161
flutter: [2023-12-29 20:47:21.694430 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694508 | Catcher | INFO] ---------- ERROR ----------
flutter: [2023-12-29 20:47:21.694635 | Catcher | INFO] Zone mismatch.
The Flutter bindings were initialized in a different zone than is now being used. This will likely cause confusion and bugs as any zone-specific configuration will inconsistently use the configuration of the original binding initialization zone or this zone based on hard-to-predict factors such as which zone was active when a particular callback was set.
It is important to use the same zone when calling `ensureInitialized` on the binding as when calling `runApp` later.
To make this warning fatal, set BindingBase.debugZoneErrorsAreFatal to true before the bindings are initialized (i.e. as the first statement in `void main() { }`).
flutter: [2023-12-29 20:47:21.694679 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694899 | Catcher | INFO] ------- STACK TRACE -------
flutter: [2023-12-29 20:47:21.695005 | Catcher | INFO] #0      BindingBase.debugCheckZone.&lt;anonymous closure&gt; (package:flutter/src/foundation/binding.dart:503:29)
flutter: [2023-12-29 20:47:21.695041 | Catcher | INFO] #1      BindingBase.debugCheckZone (package:flutter/src/foundation/binding.dart:508:6)
flutter: [2023-12-29 20:47:21.695076 | Catcher | INFO] #2      runApp (package:flutter/src/widgets/binding.dart:1093:18)
flutter: [2023-12-29 20:47:21.695120 | Catcher | INFO] #3      initApp (package:arena/main.dart:225:3)
flutter: [2023-12-29 20:47:21.695152 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695183 | Catcher | INFO] #4      main.&lt;anonymous closure&gt;.&lt;anonymous closure&gt; (package:arena/main.dart:108:37)
flutter: [2023-12-29 20:47:21.695213 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695270 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.695330 | Catcher | INFO] ======================================================================
flutter: [2023-12-29 20:47:21.695767 | Catcher | INFO] Report result: true
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://maple52046.github.io/posts/solve-widgetsflutterbinding-issue-in-flutter-with-catcher/" /><meta property="og:image" content="https://maple52046.github.io/site-thumbnail.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-12-29T21:41:53+08:00" />
<meta property="article:modified_time" content="2023-12-29T21:41:53+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://maple52046.github.io/site-thumbnail.png" /><meta name="twitter:title" content="解決在 Flutter 使用 Catcher 時遇到 WidgetsFlutterBinding 初始化的問題"/>
<meta name="twitter:description" content="最近引入 Catcher 來搜集 app 發生的錯誤訊息。按照 github 上的範例修改了 main function，初始化 Catcher:
void main() async {
  WidgetsFlutterBinding.ensureInitialized();

  Catcher(
    debugConfig: CatcherOptions(SilentReportMode(), [
      ConsoleHandler(
        enableApplicationParameters: false,
        enableDeviceParameters: false,
        enableCustomParameters: false,
        enableStackTrace: true,
      ),
    ]),
    releaseConfig: CatcherOptions(
      SilentReportMode(),
      [
        HttpHandler(
          HttpRequestType.post,
          Uri.parse(&#39;https://x.y.z&#39;),
          enableApplicationParameters: true,
          enableCustomParameters: false,
          enableDeviceParameters: true,
          enableStackTrace: false,
        ),
      ],
    ),
    runAppFunction: initApp,
    navigatorKey: myRootNavKey,
  );
}

Future&lt;void&gt; initApp() async {
  /*
    此處省略一萬個 sdk 初始化步驟 .......
  */

  runApp(const RootApp());
}
結果運行時 console 顯示錯誤：
flutter: [2023-12-29 20:47:21.680324 | Catcher | INFO] Setup localization lazily!
flutter: [2023-12-29 20:47:21.694254 | Catcher | INFO] ============================ CATCHER LOG ============================
flutter: [2023-12-29 20:47:21.694391 | Catcher | INFO] Crash occurred on 2023-12-29 20:47:21.687161
flutter: [2023-12-29 20:47:21.694430 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694508 | Catcher | INFO] ---------- ERROR ----------
flutter: [2023-12-29 20:47:21.694635 | Catcher | INFO] Zone mismatch.
The Flutter bindings were initialized in a different zone than is now being used. This will likely cause confusion and bugs as any zone-specific configuration will inconsistently use the configuration of the original binding initialization zone or this zone based on hard-to-predict factors such as which zone was active when a particular callback was set.
It is important to use the same zone when calling `ensureInitialized` on the binding as when calling `runApp` later.
To make this warning fatal, set BindingBase.debugZoneErrorsAreFatal to true before the bindings are initialized (i.e. as the first statement in `void main() { }`).
flutter: [2023-12-29 20:47:21.694679 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694899 | Catcher | INFO] ------- STACK TRACE -------
flutter: [2023-12-29 20:47:21.695005 | Catcher | INFO] #0      BindingBase.debugCheckZone.&lt;anonymous closure&gt; (package:flutter/src/foundation/binding.dart:503:29)
flutter: [2023-12-29 20:47:21.695041 | Catcher | INFO] #1      BindingBase.debugCheckZone (package:flutter/src/foundation/binding.dart:508:6)
flutter: [2023-12-29 20:47:21.695076 | Catcher | INFO] #2      runApp (package:flutter/src/widgets/binding.dart:1093:18)
flutter: [2023-12-29 20:47:21.695120 | Catcher | INFO] #3      initApp (package:arena/main.dart:225:3)
flutter: [2023-12-29 20:47:21.695152 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695183 | Catcher | INFO] #4      main.&lt;anonymous closure&gt;.&lt;anonymous closure&gt; (package:arena/main.dart:108:37)
flutter: [2023-12-29 20:47:21.695213 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695270 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.695330 | Catcher | INFO] ======================================================================
flutter: [2023-12-29 20:47:21.695767 | Catcher | INFO] Report result: true
"/>

	
        <link href="https://maple52046.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://maple52046.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css" />

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://maple52046.github.io">世界的盡頭</a>
	</div>
	<nav>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">解決在 Flutter 使用 Catcher 時遇到 WidgetsFlutterBinding 初始化的問題</h1>
			<div class="meta">Posted on Dec 29, 2023</div>
		</div>
		

		<section class="body">
			<p>最近引入 <a href="https://github.com/jhomlala/catcher">Catcher</a> 來搜集 app 發生的錯誤訊息。按照 github 上的範例修改了 main function，初始化 Catcher:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> main() <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>  WidgetsFlutterBinding.ensureInitialized();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Catcher(
</span></span><span style="display:flex;"><span>    debugConfig: CatcherOptions(SilentReportMode(), [
</span></span><span style="display:flex;"><span>      ConsoleHandler(
</span></span><span style="display:flex;"><span>        enableApplicationParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        enableDeviceParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        enableCustomParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        enableStackTrace: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      ),
</span></span><span style="display:flex;"><span>    ]),
</span></span><span style="display:flex;"><span>    releaseConfig: CatcherOptions(
</span></span><span style="display:flex;"><span>      SilentReportMode(),
</span></span><span style="display:flex;"><span>      [
</span></span><span style="display:flex;"><span>        HttpHandler(
</span></span><span style="display:flex;"><span>          HttpRequestType.post,
</span></span><span style="display:flex;"><span>          Uri.parse(<span style="color:#e6db74">&#39;https://x.y.z&#39;</span>),
</span></span><span style="display:flex;"><span>          enableApplicationParameters: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>          enableCustomParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>          enableDeviceParameters: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>          enableStackTrace: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        ),
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    runAppFunction: initApp,
</span></span><span style="display:flex;"><span>    navigatorKey: myRootNavKey,
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Future<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">void</span><span style="color:#f92672">&gt;</span> initApp() <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    此處省略一萬個 sdk 初始化步驟 .......
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  runApp(<span style="color:#66d9ef">const</span> RootApp());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>結果運行時 console 顯示錯誤：</p>
<pre tabindex="0"><code>flutter: [2023-12-29 20:47:21.680324 | Catcher | INFO] Setup localization lazily!
flutter: [2023-12-29 20:47:21.694254 | Catcher | INFO] ============================ CATCHER LOG ============================
flutter: [2023-12-29 20:47:21.694391 | Catcher | INFO] Crash occurred on 2023-12-29 20:47:21.687161
flutter: [2023-12-29 20:47:21.694430 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694508 | Catcher | INFO] ---------- ERROR ----------
flutter: [2023-12-29 20:47:21.694635 | Catcher | INFO] Zone mismatch.
The Flutter bindings were initialized in a different zone than is now being used. This will likely cause confusion and bugs as any zone-specific configuration will inconsistently use the configuration of the original binding initialization zone or this zone based on hard-to-predict factors such as which zone was active when a particular callback was set.
It is important to use the same zone when calling `ensureInitialized` on the binding as when calling `runApp` later.
To make this warning fatal, set BindingBase.debugZoneErrorsAreFatal to true before the bindings are initialized (i.e. as the first statement in `void main() { }`).
flutter: [2023-12-29 20:47:21.694679 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.694899 | Catcher | INFO] ------- STACK TRACE -------
flutter: [2023-12-29 20:47:21.695005 | Catcher | INFO] #0      BindingBase.debugCheckZone.&lt;anonymous closure&gt; (package:flutter/src/foundation/binding.dart:503:29)
flutter: [2023-12-29 20:47:21.695041 | Catcher | INFO] #1      BindingBase.debugCheckZone (package:flutter/src/foundation/binding.dart:508:6)
flutter: [2023-12-29 20:47:21.695076 | Catcher | INFO] #2      runApp (package:flutter/src/widgets/binding.dart:1093:18)
flutter: [2023-12-29 20:47:21.695120 | Catcher | INFO] #3      initApp (package:arena/main.dart:225:3)
flutter: [2023-12-29 20:47:21.695152 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695183 | Catcher | INFO] #4      main.&lt;anonymous closure&gt;.&lt;anonymous closure&gt; (package:arena/main.dart:108:37)
flutter: [2023-12-29 20:47:21.695213 | Catcher | INFO] &lt;asynchronous suspension&gt;
flutter: [2023-12-29 20:47:21.695270 | Catcher | INFO]
flutter: [2023-12-29 20:47:21.695330 | Catcher | INFO] ======================================================================
flutter: [2023-12-29 20:47:21.695767 | Catcher | INFO] Report result: true
</code></pre><p>一番 google 後發現，這是因為 <code>WidgetsFlutterBinding.ensureInitialized()</code> 與 <code>runApp</code> 在不同的 zone 裡。</p>
<p>在 stackoverflow 上看到一篇相關：<a href="https://stackoverflow.com/questions/76472459/how-do-i-fix-this-sentry-zone-mismatch-error">How do I fix this Sentry Zone mismatch error?</a>。這篇的解法是：在 <code>main</code> 中運行 <code>runZonedGuarded</code>。然後在 <code>runZonedGuarded</code> 運行 <code>WidgetsFlutterBinding.ensureInitialized()</code>、Sentry 初始化以及<code>runApp</code>。</p>
<p>但是這個方式不適合 Catcher (或是說不適合用在我的 app 裡)，因為創建 Catcher 時一定要指定 <code>runAppFunction</code> 或者 <code>rootWidget</code> 其中任一個參數。然而在我的 app 裡，<code>runApp</code> 前有很多初始化工作，我希望一併也用 Catcher 接收錯誤訊息。所以我用不了 <code>rootWidget</code> 參數；而用 <code>runAppFunction</code> 就會遇到這個問題。</p>
<p>Catcher 是有 <code>ensureInitialized</code> 這個參數。它的說明是：<code>should Catcher run WidgetsFlutterBinding.ensureInitialized() during initialization</code>。但我設定了也沒用。</p>
<p>看了 Flutter 官方的文件：<a href="https://docs.flutter.dev/release/breaking-changes/zone-errors">&ldquo;Zone mismatch&rdquo; message</a>。其中下面有一個程式片段：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> main() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> myValue <span style="color:#f92672">=</span> Mutable<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">double</span><span style="color:#f92672">&gt;</span>(<span style="color:#ae81ff">0.0</span>);
</span></span><span style="display:flex;"><span>  Zone.current.fork(
</span></span><span style="display:flex;"><span>    zoneValues: {
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#39;myKey&#39;</span><span style="color:#f92672">:</span> myValue,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ).run(() {
</span></span><span style="display:flex;"><span>    WidgetsFlutterBinding.ensureInitialized();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> newValue <span style="color:#f92672">=</span> ...; <span style="color:#75715e">// obtain value from plugin
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    myValue.value <span style="color:#f92672">=</span> newValue; <span style="color:#75715e">// update value in Zone
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    runApp(...);
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>讓我忽然有了一個靈感。</p>
<h1 id="解決方法">解決方法</h1>
<p>解決方法就是：在 <code>runAppFunction</code> 內使用 <code>main</code> 的 zone 的 <code>run</code> 去運行 <code>runApp</code> 即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dart" data-lang="dart"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> main() <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>  WidgetsFlutterBinding.ensureInitialized();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">final</span> zone <span style="color:#f92672">=</span> Zone.current;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Catcher(
</span></span><span style="display:flex;"><span>    debugConfig: CatcherOptions(SilentReportMode(), [
</span></span><span style="display:flex;"><span>      ConsoleHandler(
</span></span><span style="display:flex;"><span>        enableApplicationParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        enableDeviceParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        enableCustomParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        enableStackTrace: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>      ),
</span></span><span style="display:flex;"><span>    ]),
</span></span><span style="display:flex;"><span>    releaseConfig: CatcherOptions(
</span></span><span style="display:flex;"><span>      SilentReportMode(),
</span></span><span style="display:flex;"><span>      [
</span></span><span style="display:flex;"><span>        HttpHandler(
</span></span><span style="display:flex;"><span>          HttpRequestType.post,
</span></span><span style="display:flex;"><span>          Uri.parse(<span style="color:#e6db74">&#39;https://x.y.z&#39;</span>),
</span></span><span style="display:flex;"><span>          enableApplicationParameters: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>          enableCustomParameters: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>          enableDeviceParameters: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>          enableStackTrace: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>        ),
</span></span><span style="display:flex;"><span>      ],
</span></span><span style="display:flex;"><span>    ),
</span></span><span style="display:flex;"><span>    runAppFunction: () <span style="color:#66d9ef">async</span> <span style="color:#f92672">=&gt;</span> <span style="color:#66d9ef">await</span> initApp(zone),
</span></span><span style="display:flex;"><span>    navigatorKey: myRootNavKey,
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Future<span style="color:#f92672">&lt;</span><span style="color:#66d9ef">void</span><span style="color:#f92672">&gt;</span> initApp(Zone rootZone) <span style="color:#66d9ef">async</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    此處省略我的相關 sdk 初始化步驟
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  rootZone.run(() <span style="color:#f92672">=&gt;</span> runApp(<span style="color:#66d9ef">const</span> RootApp()));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>似乎直接在 <code>initApp</code> 裡面使用 <code>Zone.root.run()</code> 也是可以的。只是不確定這個方式會不會有問題。</p>
</blockquote>
<p>這樣就解決了。</p>
<h1 id="reference">Reference</h1>
<ul>
<li><a href="https://stackoverflow.com/questions/76472459/how-do-i-fix-this-sentry-zone-mismatch-error">How do I fix this Sentry Zone mismatch error?</a></li>
<li><a href="https://docs.flutter.dev/release/breaking-changes/zone-errors">&ldquo;Zone mismatch&rdquo; message</a></li>
</ul>
		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/flutter">flutter</a></li>
					
					<li><a href="/tags/catcher">catcher</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2024  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-GC1G5TJVGY', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</div>
    </body>
</html>
