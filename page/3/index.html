<!DOCTYPE html>
<html>
	<head lang="en">
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>世界的盡頭 | Home </title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="命中有時終須有 命中無時莫強求" />
	<meta property="og:image" content=""/>
	<link rel="alternate" type="application/rss+xml" href="https://maple52046.github.io/index.xml" title="世界的盡頭" />
	<meta property="og:title" content="世界的盡頭" />
<meta property="og:description" content="命中有時終須有 命中無時莫強求" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://maple52046.github.io/" /><meta property="og:image" content="https://maple52046.github.io/site-thumbnail.png" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://maple52046.github.io/site-thumbnail.png" /><meta name="twitter:title" content="世界的盡頭"/>
<meta name="twitter:description" content="命中有時終須有 命中無時莫強求"/>

	
        <link href="https://maple52046.github.io/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://maple52046.github.io/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css" />

	
	

	
	
	
	
</head>

	<body>
		<div class="content">
			<header>
	<div class="main">
		<a href="https://maple52046.github.io">世界的盡頭</a>
	</div>
	<nav>
		
		
	</nav>
</header>

			
			<main class="list">
				<div class="site-description"></div>
				
				
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/debugging-saltstack-states/">Debugging Saltstack States</a></h1>
					<time>Oct 16, 2015</time>
					<br><div class="description">
	
	<p>利用 Saltstack 安裝 OpenStack Keystone。按照 <a href="http://docs.openstack.org/kilo/install-guide/install/apt/content/keystone-services.html">OpenStack 官方安裝手冊</a>，裝完 Keystone 之後，必須要為 Keystone 自己註冊 service 與 endpoint。</p>
<p>這一個步驟，我把他寫成 Saltstack states 如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">waiting-keystone-startup</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">cmd.run</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">sleep 1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">registry-keystone-service</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">keystone.service_present</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">keystone</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">service_type</span>: <span style="color:#ae81ff">identity</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">description</span>: <span style="color:#e6db74">&#34;OpenStack Identity&#34;</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">require</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">cmd</span>: <span style="color:#ae81ff">waiting-keystone-startup</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">registry-keystone-endpoint</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">keystone.endpoint_present</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">keystone</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">publicurl</span>: <span style="color:#ae81ff">http://host-01:5000/v2.0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">internalurl</span>: <span style="color:#ae81ff">http://host-01:5000/v2.0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">adminurl</span>: <span style="color:#ae81ff">http://host-01:35357/v2.0</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">region</span>: <span style="color:#ae81ff">regionOne</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">require</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">keystone</span>: <span style="color:#ae81ff">registry-keystone-service</span>
</span></span></code></pre></div><p>結果執行時發生 KeyError:</p>
<pre tabindex="0"><code>user@host-01:/srv/salt/openstack/keystone$ salt &#39;*&#39; state.sls openstack.keystone.registry
host-01:
    The minion function caused an exception: Traceback (most recent call last):
      File &#34;/usr/lib/python2.7/dist-packages/salt/minion.py&#34;, line 1161, in _thread_return
        return_data = func(*args, **kwargs)
      File &#34;/usr/lib/python2.7/dist-packages/salt/modules/state.py&#34;, line 681, in sls
        ret = st_.state.call_high(high_)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 2067, in call_high
        ret = dict(list(disabled.items()) + list(self.call_chunks(chunks).items()))
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1623, in call_chunks
        running = self.call_chunk(low, running, chunks)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 1769, in call_chunk
        self._mod_init(low)
      File &#34;/usr/lib/python2.7/dist-packages/salt/state.py&#34;, line 612, in _mod_init
        self.states[&#39;{0}.{1}&#39;.format(low[&#39;state&#39;], low[&#39;fun&#39;])]  # pylint: disable=W0106
      File &#34;/usr/lib/python2.7/dist-packages/salt/utils/lazy.py&#34;, line 90, in __getitem__
        raise KeyError(key)
    KeyError: &#39;keystone.service_present&#39;
</code></pre>&hellip;
	
</div>
					<a class="readmore" href="/posts/debugging-saltstack-states/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/solve-qcow2-file-too-large-could-not-read-snapshots/">解決 qcow2 image : Could not read snapshots. File too large</a></h1>
					<time>Jul 22, 2015</time>
					<br><div class="description">
	
	<p>在 KVM VM running 的中，執行了 <code>qemu-img snapshot -c ....</code>，可能是沒有算好 image 的剩餘空間，也可能是某種 bug，總之，當 VM 關機後，就再也開不起來了。</p>
<p><code>qemu-img info</code> 會產生錯誤：</p>
<pre tabindex="0"><code>Host1 # qemu-img info portal.img
qemu-img: Could not open &#39;portal.img&#39;: Could not read snapshots: File too large
</code></pre>&hellip;
	
</div>
					<a class="readmore" href="/posts/solve-qcow2-file-too-large-could-not-read-snapshots/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/cross-compile-for-openwrt/">Cross-compile for OpenWRT</a></h1>
					<time>May 14, 2015</time>
					<br><div class="description">
	
	<p>這是一個實驗，在 Ubuntu 上編譯可以在 OpenWRT 上運行的程式。
參考並修改別人的方式，完成了幾個簡單的範例。</p>
<ul>
<li>編譯環境：
<ul>
<li>Operating System: Ubuntu 14.04 x64</li>
<li>OpenWRT version: 14.07</li>
</ul>
</li>
</ul>&hellip;
	
</div>
					<a class="readmore" href="/posts/cross-compile-for-openwrt/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/compile-openwrt-x86-kvm-guest/">Compile OpenWRT x86 (KVM guest, VirtualBox)</a></h1>
					<time>May 7, 2015</time>
					<br><div class="description">
	
	<p>編譯 x86 版的 OpenWRT 與之前的方式雷同，基本上差別的就在於 <code>make menuconfig</code> 的時候要作一些額外的修改。</p>
<p>詳細的 OpenWRT 編譯流程請參考：<a href="http://worldend.logdown.com/posts/256561-compile-openwrt-with-open-vswitch">Compile OpenWRT with Open vSwitch</a>，本篇不再贅述。</p>&hellip;
	
</div>
					<a class="readmore" href="/posts/compile-openwrt-x86-kvm-guest/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/ipv6-neighbour-table-overflow/">IPv6 Neighbour table overflow</a></h1>
					<time>May 1, 2015</time>
					<br><div class="description">
	
	<p>這兩天一直在 syslog 上看到 <code>Neighbour table overflow</code></p>
<pre tabindex="0"><code class="language-syslog" data-lang="syslog">Apr 30 06:27:03 host-42 kernel: [72924.290265] net_ratelimit: 1739 callbacks suppressed
Apr 30 06:27:03 host-42 kernel: [72924.290269] IPv6: Neighbour table overflow
</code></pre><p>每兩分鐘就出現6~7筆,數量非常的多
如果不處理它，放任它繼續增長，過一兩天後系統就會 kernel panic。</p>&hellip;
	
</div>
					<a class="readmore" href="/posts/ipv6-neighbour-table-overflow/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/openstack-glance-image-list-401/">OpenStack Glance Image-list 401</a></h1>
					<time>Apr 8, 2015</time>
					<br><div class="description">
	
	<p>架設 OpenStack Juno ，安裝完 Glance 後進行測試時，glance 指令會一直出現 401 錯誤。</p>
<pre tabindex="0"><code>root@localhost:~# glance --debug image-list
curl -i -X GET -H &#39;User-Agent: python-glanceclient&#39; -H &#39;Content-Type: application/octet-stream&#39; -H &#39;Accept-Encoding: gzip, deflate, compress&#39; -H &#39;Accept: */*&#39; -H &#39;X-Auth-Token: ***&#39; http://140.114.91.220:9292/v1/images/detail?sort_key=name&amp;sort_dir=asc&amp;limit=20
Request returned failure status 401.
Invalid OpenStack Identity credentials.
</code></pre>&hellip;
	
</div>
					<a class="readmore" href="/posts/openstack-glance-image-list-401/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/force-confirm-gitlab-user/">暴力啟用 gitlab user</a></h1>
					<time>Mar 27, 2015</time>
					<br><div class="description">
	
	<p>下這個標題不知道是不是很奇怪XD</p>
<p>最近在為自己的 team 開發一個 management 系統，於是決定在 gitlab 上開 project。用了 team 的 email 註冊，但是不知道為什麼總是收不到驗證信。於是&hellip;不小心找了個旁門左道 XD</p>&hellip;
	
</div>
					<a class="readmore" href="/posts/force-confirm-gitlab-user/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/configure-open-vswitch-in-openwrt/">Configure Open vSwitch in OpenWRT</a></h1>
					<time>Mar 18, 2015</time>
					<br><div class="description">
	
	<p>當你安裝完 Open vSwitch 或是燒了一個<a href="http://worldend.logdown.com/posts/256561-compile-openwrt-with-open-vswitch">內建 Open vSwitch 的 OpenWRT</a> 後，接下來要將網卡綁到 Open vSwitch 上。</p>&hellip;
	
</div>
					<a class="readmore" href="/posts/configure-open-vswitch-in-openwrt/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/compile-openwrt-with-open-vswitch/">Compile OpenWRT with Open vSwitch</a></h1>
					<time>Mar 5, 2015</time>
					<br><div class="description">
	
	<p>雖然說在 google 上很多資料都說，Open vSwitch 已經加入到 OpenWRT 的 packages repository，而且在 GitHub 上也有看到 <a href="https://github.com/openwrt/packages/tree/master/net/openvswitch">Open vSwitch</a> 的身影。但是實際上，在官方的 <a href="https://downloads.openwrt.org/barrier_breaker/14.07/">repository</a> 中並沒有 Open vSwitch。因此決定自行編譯。</p>
<h1 id="實驗環境"><strong>實驗環境</strong></h1>
<ul>
<li>
<p>編譯環境</p>
<ul>
<li>Operating System: Ubuntu 14.04 x64</li>
<li>OpenWRT version: 14.07</li>
<li>Open vSwitch version: 2.3.1</li>
</ul>
</li>
<li>
<p>路由器</p>
<ul>
<li><a href="http://www.tp-link.tw/products/details/?model=TL-WR1043ND">TP-Link TL-WR1043ND</a></li>
</ul>
</li>
</ul>&hellip;
	
</div>
					<a class="readmore" href="/posts/compile-openwrt-with-open-vswitch/">Read more ⟶</a>
				</section>
				
				<section class="list-item">
					<h1 class="title"><a href="/posts/rally-installation/">Install Rally 筆記 (OpenStack benchmark)</a></h1>
					<time>Feb 24, 2015</time>
					<br><div class="description">
	
	<p><a href="http://rally.readthedocs.org/en/latest/index.html">Rally</a> 是一套 OpenStack benchmark tool。關於 Rally 的介紹本文就不再贅述。本篇安裝時是以 <a href="https://wiki.openstack.org/wiki/Rally#How_To">OpenStack 官方 Wiki</a> 的教學為參考內容，紀錄安裝與使用 Rally 的筆記。</p>&hellip;
	
</div>
					<a class="readmore" href="/posts/rally-installation/">Read more ⟶</a>
				</section>
				
				

<ul class="pagination">
	<span class="page-item page-prev">
	
    <a href="/page/2/" class="page-link" aria-label="Previous"><span aria-hidden="true">← Prev</span></a>
	
	</span>
	<span class="page-item page-next">
	
    <a href="/page/4/" class="page-link" aria-label="Next"><span aria-hidden="true">Next →</span></a>
	
	</span>
</ul>


			</main>
			<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2024  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-GC1G5TJVGY', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


		</div>
		
	</body>
</html>
